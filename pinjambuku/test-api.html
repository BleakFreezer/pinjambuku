<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>API Test - PinjamanBuku</title>
    <link rel="shortcut icon" href="Image/favicon.ico" type="image/x-icon" />
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: #f5f5f5;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 8px;
      }
      .test-section {
        margin-bottom: 30px;
        border: 1px solid #ddd;
        padding: 15px;
        border-radius: 5px;
      }
      input,
      button {
        padding: 10px;
        margin: 5px;
        font-size: 14px;
      }
      button {
        background: #6366f1;
        color: white;
        border: none;
        cursor: pointer;
        border-radius: 5px;
      }
      button:hover {
        background: #4f46e5;
      }
      .result {
        background: #f0f0f0;
        padding: 15px;
        margin-top: 10px;
        border-radius: 5px;
        max-height: 400px;
        overflow-y: auto;
        font-size: 12px;
        font-family: monospace;
        white-space: pre-wrap;
      }
      .success {
        color: green;
        font-weight: bold;
      }
      .error {
        color: red;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üîç API Testing Tool</h1>

      <div class="test-section">
        <h2>Test 1: OpenLibrary Search</h2>
        <input
          type="text"
          id="olQuery"
          placeholder="Enter title..."
          value="earth science"
        />
        <button onclick="testOpenLibrary()">Test OpenLibrary API</button>
        <div id="olResult" class="result"></div>
      </div>

      <div class="test-section">
        <h2>Test 2: Get OpenLibrary Book Details</h2>
        <input
          type="text"
          id="olBookId"
          placeholder="Enter book ID..."
          value="/works/OL1780567W"
        />
        <button onclick="testOpenLibraryDetail()">
          Get OpenLibrary Details
        </button>
        <div id="olDetailResult" class="result"></div>
      </div>

      <div class="test-section">
        <h2>Test 3: Google Books by ISBN</h2>
        <input
          type="text"
          id="isbnQuery"
          placeholder="Enter ISBN..."
          value="0395857759"
        />
        <button onclick="testGoogleBooksISBN()">
          Test Google Books (ISBN)
        </button>
        <div id="isbnResult" class="result"></div>
      </div>

      <div class="test-section">
        <h2>Test 4: Google Books by Title</h2>
        <input
          type="text"
          id="titleQuery"
          placeholder="Enter title..."
          value="earth science"
        />
        <button onclick="testGoogleBooksTitle()">
          Test Google Books (Title)
        </button>
        <div id="titleResult" class="result"></div>
      </div>
    </div>

    <script>
      const GOOGLE_BOOKS_API = "https://www.googleapis.com/books/v1/volumes";
      const GOOGLE_BOOKS_API_KEY = "AIzaSyA0KR2gj5dujlY8OMlqF833PgrYW8gnjI8";

      async function testOpenLibrary() {
        const query = document.getElementById("olQuery").value;
        const resultEl = document.getElementById("olResult");

        try {
          resultEl.innerHTML = "Loading...";
          const response = await fetch(
            `https://openlibrary.org/search.json?q=${encodeURIComponent(
              query
            )}&limit=3`
          );
          const data = await response.json();

          let html = `<span class="success">‚úÖ Success!</span>\n`;
          html += `Total results: ${data.numFound}\n\n`;

          if (data.docs && data.docs.length > 0) {
            data.docs.forEach((book, idx) => {
              html += `\nüìö Book ${idx + 1}:\n`;
              html += `  Title: ${book.title}\n`;
              html += `  Author: ${
                book.author_name ? book.author_name.join(", ") : "N/A"
              }\n`;
              html += `  Key: ${book.key}\n`;
              html += `  ISBN: ${book.isbn ? book.isbn[0] : "N/A"}\n`;
              html += `  First Edition ID: ${
                book.edition_key ? book.edition_key[0] : "N/A"
              }\n`;
            });
          }

          resultEl.innerHTML = html;
        } catch (error) {
          resultEl.innerHTML = `<span class="error">‚ùå Error: ${error.message}</span>`;
        }
      }

      async function testOpenLibraryDetail() {
        const bookId = document.getElementById("olBookId").value;
        const resultEl = document.getElementById("olDetailResult");

        try {
          resultEl.innerHTML = "Loading...";
          const response = await fetch(`https://openlibrary.org${bookId}.json`);
          const data = await response.json();

          let html = `<span class="success">‚úÖ Success!</span>\n`;
          html += `\n=== Full Book Data ===\n`;
          html += JSON.stringify(data, null, 2);

          resultEl.innerHTML = html;
        } catch (error) {
          resultEl.innerHTML = `<span class="error">‚ùå Error: ${error.message}</span>`;
        }
      }

      async function testGoogleBooksISBN() {
        const isbn = document.getElementById("isbnQuery").value;
        const resultEl = document.getElementById("isbnResult");

        try {
          resultEl.innerHTML = "Loading...";
          const url = `${GOOGLE_BOOKS_API}?q=isbn:${isbn}&key=${GOOGLE_BOOKS_API_KEY}`;
          console.log("Request URL:", url);

          const response = await fetch(url);
          const data = await response.json();

          let html = `<span class="success">‚úÖ Success!</span>\n`;
          html += `Total results: ${data.totalItems}\n`;

          if (data.items && data.items.length > 0) {
            const book = data.items[0];
            html += `\n=== Book Found ===\n`;
            html += `Title: ${book.volumeInfo.title}\n`;
            html += `Authors: ${(book.volumeInfo.authors || []).join(", ")}\n`;
            html += `Publisher: ${book.volumeInfo.publisher || "N/A"}\n`;
            html += `Published Date: ${
              book.volumeInfo.publishedDate || "N/A"
            }\n`;
            html += `Pages: ${book.volumeInfo.pageCount || "N/A"}\n`;
            html += `Language: ${book.volumeInfo.language || "N/A"}\n`;
            html += `Categories: ${
              (book.volumeInfo.categories || []).join(", ") || "N/A"
            }\n`;
            html += `Description: ${
              book.volumeInfo.description
                ? book.volumeInfo.description.substring(0, 100) + "..."
                : "N/A"
            }\n`;
            html += `\n=== Full Data ===\n`;
            html += JSON.stringify(book, null, 2);
          } else {
            html += `<span class="error">No books found</span>`;
          }

          resultEl.innerHTML = html;
        } catch (error) {
          resultEl.innerHTML = `<span class="error">‚ùå Error: ${error.message}</span>`;
        }
      }

      async function testGoogleBooksTitle() {
        const title = document.getElementById("titleQuery").value;
        const resultEl = document.getElementById("titleResult");

        try {
          resultEl.innerHTML = "Loading...";
          const url = `${GOOGLE_BOOKS_API}?q=${encodeURIComponent(
            title
          )}&maxResults=3&key=${GOOGLE_BOOKS_API_KEY}`;
          console.log("Request URL:", url);

          const response = await fetch(url);
          const data = await response.json();

          let html = `<span class="success">‚úÖ Success!</span>\n`;
          html += `Total results found: ${data.totalItems}\n`;

          if (data.items && data.items.length > 0) {
            data.items.forEach((book, idx) => {
              html += `\n\nüìö Result ${idx + 1}:\n`;
              html += `Title: ${book.volumeInfo.title}\n`;
              html += `Authors: ${(book.volumeInfo.authors || []).join(
                ", "
              )}\n`;
              html += `Publisher: ${book.volumeInfo.publisher || "N/A"}\n`;
              html += `Published Date: ${
                book.volumeInfo.publishedDate || "N/A"
              }\n`;
              html += `Pages: ${book.volumeInfo.pageCount || "N/A"}\n`;
              html += `Language: ${book.volumeInfo.language || "N/A"}\n`;
              html += `Categories: ${
                (book.volumeInfo.categories || []).join(", ") || "N/A"
              }\n`;
            });
          } else {
            html += `<span class="error">No books found</span>`;
          }

          resultEl.innerHTML = html;
        } catch (error) {
          resultEl.innerHTML = `<span class="error">‚ùå Error: ${error.message}</span>`;
        }
      }

      // Auto-run tests on load
      window.addEventListener("load", () => {
        console.log("Test page loaded. Click buttons to test APIs.");
      });
    </script>
  </body>
</html>
